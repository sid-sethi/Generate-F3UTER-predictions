# Pipeline for making 3'UTR predictions using F3UTER

This `snakemake` pipeline uses the F3UTER trained model to classify the input regions into potential 3'UTRs and non-3'UTRs. F3UTER was trained on a set of known 3’UTRs (positive examples) and non-3’UTRs (negative examples) from Ensembl human genome annotation (v94). The trained F3UTER model is provided in `/data/rf_model.rda`. F3UTER achieved a mean accuracy of 0.96, sensitivity of 0.92, specificity of 0.96, kappa of 0.78, AUC-ROC of 0.98 and AUC-PRC of 0.91 on the validation datasets (hold out) in 5-fold cross validation. This pipeline compiles the different features into a feature matrix and applies F3UTER to it to make predictions.


# Getting Started

## Input

- Calculated features for your regions of interest: output of [Generate F3UTER features](https://github.com/sid-sethi/Generate-F3UTER-features).
- Regions of interest: input file provided to [Generate F3UTER features](https://github.com/sid-sethi/Generate-F3UTER-features).

## Output

The main output files generated by the pipeline are:

- `F3UTER_prediction/<sample_name>_ml_table.rds` - compiled feature matrix for F3UTER (R object)
- `F3UTER_prediction/<sample_name>_predictions.txt` - predictions from F3UTER
- `F3UTER_prediction/<sample_name>_predictions_meta.txt` - predictions from F3UTER and meta-data added from ER/BED file
- `F3UTER_prediction/<sample_name>_predictions.bed` - predictions in BED format for displaying on UCSC

## Depedencies

- [miniconda](https://conda.io/miniconda.html)
- [snakemake](http://snakemake.readthedocs.io/en/latest/) - can be installed via conda
- The rest of the dependencies (R packages) are installed via conda.

## Installation

Clone the pipeline:

```bash
git clone --recursive https://github.com/sid-sethi/Generate-F3UTER-predictions.git
```

## Usage

Edit `config.yml` to set up the working directory and input files. `Snakemake` command should be issued from within the pipeline directory.

```bash
cd Generate-F3UTER-predictions
snakemake --use-conda -j <num_cores> all
```
This pipeline uses only 1 core at most. It is a good idea to do a dry run (using -n parameter) to view what would be done by the pipeline before executing the pipeline.

```bash
snakemake --use-conda -n all
```
Snakemake can be run to only install the required conda environments without running the full workflow. Subsequent runs with --use-conda will make use of the local environments without requiring internet access. This is suitable for running the pipeline offline.

```bash
snakemake --use-conda --conda-create-envs-only
```

## Licence

Copyright 2020 Astex Therapeutics Ltd.

This repository is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

This repository is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the [LICENSE](LICENSE) file (GNU General Public License) for more details.
